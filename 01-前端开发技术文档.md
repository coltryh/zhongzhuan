# æ‹œè€³æ™ºèƒ½æ‹›é‡‡å¹³å° - å‰ç«¯å¼€å‘æŠ€æœ¯æ–‡æ¡£

> æœ¬æ–‡æ¡£ä¸“ä¸ºå‰ç«¯å¼€å‘æ–°æ‰‹ç¼–å†™ï¼Œè¯¦ç»†è®²è§£é¡¹ç›®çš„å‰ç«¯æŠ€æœ¯æ ˆã€æ¨¡å—ç»“æ„ã€ç•Œé¢å®ç°å’Œäº¤äº’é€»è¾‘ã€‚

---

## ç›®å½•

- [ä¸€ã€é¡¹ç›®æ¦‚è¿°](#ä¸€é¡¹ç›®æ¦‚è¿°)
- [äºŒã€å‰ç«¯æŠ€æœ¯æ ˆè¯¦è§£](#äºŒå‰ç«¯æŠ€æœ¯æ ˆè¯¦è§£)
- [ä¸‰ã€é¡¹ç›®ç»“æ„ä¸é…ç½®](#ä¸‰é¡¹ç›®ç»“æ„ä¸é…ç½®)
- [å››ã€æ ¸å¿ƒæ¦‚å¿µä¸åŸç†](#å››æ ¸å¿ƒæ¦‚å¿µä¸åŸç†)
- [äº”ã€ç•Œé¢å®ç°è¯¦è§£](#äº”ç•Œé¢å®ç°è¯¦è§£)
- [å…­ã€å…¬å…±ç»„ä»¶ä½¿ç”¨](#å…­å…¬å…±ç»„ä»¶ä½¿ç”¨)
- [ä¸ƒã€å¼€å‘å®æˆ˜æ•™ç¨‹](#ä¸ƒå¼€å‘å®æˆ˜æ•™ç¨‹)
- [å…«ã€å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ](#å…«å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ)
- [ä¹ã€æ€§èƒ½ä¼˜åŒ–å»ºè®®](#ä¹æ€§èƒ½ä¼˜åŒ–å»ºè®®)

---

## ä¸€ã€é¡¹ç›®æ¦‚è¿°

### 1.1 é¡¹ç›®ç®€ä»‹

**é¡¹ç›®åç§°**ï¼šæ‹œè€³ä¸­å›½-åä¸œåŒºæ‹›æ ‡é‡‡è´­æµç¨‹ç®¡ç†ç³»ç»Ÿï¼ˆBayer Bidding Process Systemï¼‰

**ä¸šåŠ¡é¢†åŸŸ**ï¼šåŒ»è¯è¡Œä¸šæ‹›æ ‡é‡‡è´­ç®¡ç†

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- é¡¹ç›®ç®¡ç†ï¼ˆå›½è°ˆã€å¸¦é‡‡ã€æŒ‚ç½‘ç­‰ï¼‰
- èµ„æ–™åº“ç®¡ç†ï¼ˆäº§å“èµ„æ–™ã€ä¼ä¸šèµ„æ–™ã€é‚®ä»¶èµ„æ–™ï¼‰
- ä»·æ ¼åº“ç®¡ç†ï¼ˆæœ¬å“ä»·æ ¼ã€ç«å“ä»·æ ¼ï¼‰
- äº§å“åº“ç®¡ç†
- å¾…åŠä»»åŠ¡ç®¡ç†
- å·¥ä½œæµå®¡æ‰¹

### 1.2 å‰ç«¯æ¶æ„ç‰¹ç‚¹

âœ… **æŠ€æœ¯ç°ä»£åŒ–**ï¼šVue 3 + TypeScript + Vite
âœ… **ç»„ä»¶åŒ–å¼€å‘**ï¼šElement Plus UIç»„ä»¶åº“
âœ… **ç±»å‹å®‰å…¨**ï¼šå…¨é¢ä½¿ç”¨TypeScript
âœ… **çŠ¶æ€ç®¡ç†**ï¼šPiniaï¼ˆVuexçš„æ›¿ä»£å“ï¼‰
âœ… **å·¥ç¨‹åŒ–**ï¼šViteæ„å»ºå·¥å…·ï¼Œå¼€å‘ä½“éªŒæä½³

---

## äºŒã€å‰ç«¯æŠ€æœ¯æ ˆè¯¦è§£

### 2.1 æ ¸å¿ƒæ¡†æ¶

#### Vue 3.5.22

Vue 3 æ˜¯å½“å‰æœ€æ–°çš„ Vue ç‰ˆæœ¬ï¼Œä¸»è¦ç‰¹ç‚¹ï¼š

**Composition APIï¼ˆç»„åˆå¼APIï¼‰**
```vue
<script setup lang="ts">
// Vue 2 çš„ Options API
export default {
  data() {
    return { count: 0 }
  },
  methods: {
    increment() {
      this.count++
    }
  }
}

// Vue 3 çš„ Composition APIï¼ˆæ¨èï¼‰
import { ref } from 'vue'

const count = ref(0)
const increment = () => {
  count.value++
}
</script>
```

**ä¸ºä»€ä¹ˆä½¿ç”¨ Composition APIï¼Ÿ**
1. æ›´å¥½çš„é€»è¾‘å¤ç”¨
2. æ›´å¥½çš„ç±»å‹æ¨æ–­
3. æ›´çµæ´»çš„ä»£ç ç»„ç»‡
4. æ›´å°çš„æ‰“åŒ…ä½“ç§¯

#### TypeScript 5.9.0

TypeScript æ˜¯ JavaScript çš„è¶…é›†ï¼Œæ·»åŠ äº†ç±»å‹ç³»ç»Ÿã€‚

**åŸºæœ¬ç±»å‹ä½¿ç”¨**
```typescript
// å­—ç¬¦ä¸²
let name: string = 'å¼ ä¸‰'

// æ•°å­—
let age: number = 25

// æ•°ç»„
let scores: number[] = [90, 85, 95]
// æˆ–è€…
let scores: Array<number> = [90, 85, 95]

// å¯¹è±¡
interface User {
  id: number
  name: string
  email?: string  // å¯é€‰å±æ€§
}

let user: User = {
  id: 1,
  name: 'æå››'
}
```

**å‡½æ•°ç±»å‹**
```typescript
// å‡½æ•°å£°æ˜
function add(a: number, b: number): number {
  return a + b
}

// ç®­å¤´å‡½æ•°
const multiply = (a: number, b: number): number => {
  return a * b
}

// å¼‚æ­¥å‡½æ•°
async function getUser(id: number): Promise<User> {
  const response = await fetch(`/api/users/${id}`)
  return response.json()
}
```

### 2.2 æ„å»ºå·¥å…·

#### Vite 7.1.11

Vite æ˜¯æ–°ä¸€ä»£å‰ç«¯æ„å»ºå·¥å…·ï¼Œå¼€å‘æœåŠ¡å™¨å¯åŠ¨é€Ÿåº¦æå¿«ã€‚

**æ ¸å¿ƒé…ç½®**ï¼ˆvite.config.tsï¼‰
```typescript
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'

export default defineConfig({
  plugins: [vue()],  // Vue 3 æ’ä»¶

  base: '/bayer/',   // éƒ¨ç½²è·¯å¾„å‰ç¼€

  resolve: {
    alias: {
      '@': fileURLToPath(new URL('./src', import.meta.url))  // è·¯å¾„åˆ«å
    }
  },

  css: {
    preprocessorOptions: {
      scss: {
        // è‡ªåŠ¨æ³¨å…¥å…¨å±€ SCSS å˜é‡
        additionalData: (content: string, filePath: string) => {
          if (filePath.includes('node_modules')) {
            return content
          }
          return `@use "@/styles/variables.scss" as *;\n${content}`
        }
      }
    }
  }
})
```

**Vite çš„ä¼˜åŠ¿**ï¼š
- âš¡ï¸ æå¿«çš„å†·å¯åŠ¨é€Ÿåº¦
- âš¡ï¸ å³æ—¶çš„çƒ­æ¨¡å—æ›´æ–°ï¼ˆHMRï¼‰
- ğŸ“¦ ä¼˜åŒ–çš„æ„å»ºè¾“å‡º
- ğŸ”§ ä¸°å¯Œçš„æ’ä»¶ç”Ÿæ€

### 2.3 UIç»„ä»¶åº“

#### Element Plus 2.11.7

Element Plus æ˜¯ Vue 3 çš„ä¼ä¸šçº§ UI ç»„ä»¶åº“ã€‚

**å¸¸ç”¨ç»„ä»¶**ï¼š

**1. è¡¨å•ç»„ä»¶**
```vue
<template>
  <el-form ref="formRef" :model="form" :rules="rules" label-width="120px">
    <el-form-item label="ç”¨æˆ·å" prop="username">
      <el-input v-model="form.username" clearable />
    </el-form-item>

    <el-form-item label="å¯†ç " prop="password">
      <el-input v-model="form.password" type="password" show-password />
    </el-form-item>

    <el-form-item label="æ€§åˆ«" prop="gender">
      <el-radio-group v-model="form.gender">
        <el-radio label="male">ç”·</el-radio>
        <el-radio label="female">å¥³</el-radio>
      </el-radio-group>
    </el-form-item>

    <el-form-item label="åŸå¸‚" prop="city">
      <el-select v-model="form.city" placeholder="è¯·é€‰æ‹©åŸå¸‚">
        <el-option label="åŒ—äº¬" value="beijing" />
        <el-option label="ä¸Šæµ·" value="shanghai" />
      </el-select>
    </el-form-item>

    <el-form-item label="æ—¥æœŸ" prop="date">
      <el-date-picker
        v-model="form.date"
        type="date"
        placeholder="é€‰æ‹©æ—¥æœŸ"
      />
    </el-form-item>
  </el-form>
</template>

<script setup lang="ts">
import { ref, reactive } from 'vue'
import type { FormInstance, FormRules } from 'element-plus'

const formRef = ref<FormInstance>()

// è¡¨å•æ•°æ®
const form = reactive({
  username: '',
  password: '',
  gender: '',
  city: '',
  date: ''
})

// è¡¨å•éªŒè¯è§„åˆ™
const rules = reactive<FormRules>({
  username: [
    { required: true, message: 'è¯·è¾“å…¥ç”¨æˆ·å', trigger: 'blur' },
    { min: 3, max: 10, message: 'é•¿åº¦åœ¨ 3 åˆ° 10 ä¸ªå­—ç¬¦', trigger: 'blur' }
  ],
  password: [
    { required: true, message: 'è¯·è¾“å…¥å¯†ç ', trigger: 'blur' },
    { min: 6, message: 'å¯†ç è‡³å°‘6ä½', trigger: 'blur' }
  ],
  city: [
    { required: true, message: 'è¯·é€‰æ‹©åŸå¸‚', trigger: 'change' }
  ]
})

// æäº¤è¡¨å•
const submitForm = async () => {
  if (!formRef.value) return

  try {
    await formRef.value.validate()  // éªŒè¯è¡¨å•
    console.log('è¡¨å•éªŒè¯é€šè¿‡:', form)
    // æäº¤åˆ°åç«¯
  } catch (error) {
    console.log('è¡¨å•éªŒè¯å¤±è´¥:', error)
  }
}
</script>
```

**2. è¡¨æ ¼ç»„ä»¶**
```vue
<template>
  <el-table :data="tableData" border stripe>
    <el-table-column prop="name" label="å§“å" width="120" />
    <el-table-column prop="age" label="å¹´é¾„" width="80" />
    <el-table-column prop="email" label="é‚®ç®±" />
    <el-table-column prop="role" label="è§’è‰²">
      <template #default="{ row }">
        <el-tag :type="row.role === 'admin' ? 'danger' : 'success'">
          {{ row.role }}
        </el-tag>
      </template>
    </el-table-column>
    <el-table-column label="æ“ä½œ" width="200">
      <template #default="{ row }">
        <el-button size="small" @click="handleEdit(row)">ç¼–è¾‘</el-button>
        <el-button size="small" type="danger" @click="handleDelete(row)">
          åˆ é™¤
        </el-button>
      </template>
    </el-table-column>
  </el-table>
</template>

<script setup lang="ts">
interface User {
  id: number
  name: string
  age: number
  email: string
  role: string
}

const tableData = ref<User[]>([
  { id: 1, name: 'å¼ ä¸‰', age: 25, email: 'zhangsan@example.com', role: 'admin' },
  { id: 2, name: 'æå››', age: 30, email: 'lisi@example.com', role: 'user' }
])

const handleEdit = (row: User) => {
  console.log('ç¼–è¾‘:', row)
}

const handleDelete = (row: User) => {
  console.log('åˆ é™¤:', row)
}
</script>
```

**3. åˆ†é¡µç»„ä»¶**
```vue
<template>
  <el-pagination
    v-model:current-page="currentPage"
    v-model:page-size="pageSize"
    :page-sizes="[10, 20, 30, 40]"
    :total="total"
    layout="total, sizes, prev, pager, next, jumper"
    @size-change="handleSizeChange"
    @current-change="handleCurrentChange"
  />
</template>

<script setup lang="ts">
import { ref } from 'vue'

const currentPage = ref(1)
const pageSize = ref(10)
const total = ref(100)

const handleSizeChange = (size: number) => {
  pageSize.value = size
  // é‡æ–°åŠ è½½æ•°æ®
  loadData()
}

const handleCurrentChange = (page: number) => {
  currentPage.value = page
  // é‡æ–°åŠ è½½æ•°æ®
  loadData()
}
</script>
```

**4. å¼¹çª—ç»„ä»¶**
```vue
<template>
  <el-button @click="dialogVisible = true">æ‰“å¼€å¼¹çª—</el-button>

  <el-dialog v-model="dialogVisible" title="æç¤º" width="30%">
    <span>è¿™æ˜¯ä¸€æ®µå†…å®¹</span>
    <template #footer>
      <el-button @click="dialogVisible = false">å–æ¶ˆ</el-button>
      <el-button type="primary" @click="handleConfirm">ç¡®å®š</el-button>
    </template>
  </el-dialog>
</template>

<script setup lang="ts">
import { ref } from 'vue'

const dialogVisible = ref(false)

const handleConfirm = () => {
  // å¤„ç†ç¡®å®šé€»è¾‘
  dialogVisible.value = false
}
</script>
```

### 2.4 çŠ¶æ€ç®¡ç†

#### Pinia 3.0.3

Pinia æ˜¯ Vue 3 å®˜æ–¹æ¨èçš„çŠ¶æ€ç®¡ç†åº“ï¼Œæ˜¯ Vuex çš„æ›¿ä»£å“ã€‚

**åˆ›å»º Store**
```typescript
// stores/user.ts
import { defineStore } from 'pinia'
import { ref, computed } from 'vue'

interface User {
  userId: number
  username: string
  nickname: string
  email: string
  roles: Role[]
}

interface Role {
  roleId: number
  roleCode: string
  roleName: string
}

interface UserState {
  user: User | null
  token: string
}

export const useUserStore = defineStore('user', {
  // çŠ¶æ€
  state: (): UserState => ({
    user: null,
    token: '',
    publicKeyLoaded: false
  }),

  // è®¡ç®—å±æ€§
  getters: {
    isAuthenticated: (state) => !!state.token,
    displayName: (state) => state.user?.username ?? 'åŒ¿å',
    getUsername: (state) => state.user?.nickname ?? 'Guest'
  },

  // æ–¹æ³•
  actions: {
    // è®¾ç½®ç”¨æˆ·ä¿¡æ¯
    setUser(user: User) {
      this.user = user
    },

    // è®¾ç½® token
    setToken(token: string) {
      this.token = token
    },

    // ç™»å½•
    async login(payload: { email: string; password: string }) {
      const res = await login({
        email: payload.email,
        password: payload.password
      })
      this.setToken(res.data.token)
      this.setUser(res.data)
    },

    // æ£€æŸ¥è§’è‰²æƒé™
    hasRole(roleCode: string | string[]): boolean {
      if (!this.user?.roles) return false
      return this.user.roles.some(role =>
        Array.isArray(roleCode)
          ? roleCode.includes(role.roleCode)
          : role.roleCode === roleCode
      )
    },

    // ç™»å‡º
    logout() {
      this.user = null
      this.token = ''
      sessionStorage.clear()
    }
  },

  // æŒä¹…åŒ–é…ç½®
  persist: {
    key: 'user',
    storage: sessionStorage  // ä½¿ç”¨ sessionStorage
  }
})
```

**ä½¿ç”¨ Store**
```vue
<script setup lang="ts">
import { useUserStore } from '@/stores/user'

const userStore = useUserStore()

// è®¿é—®çŠ¶æ€
console.log(userStore.user)
console.log(userStore.token)

// è®¿é—®è®¡ç®—å±æ€§
console.log(userStore.isAuthenticated)
console.log(userStore.displayName)

// è°ƒç”¨æ–¹æ³•
userStore.setUser({ /* ... */ })
userStore.setToken('xxx')
userStore.logout()

// åœ¨ç»„ä»¶ä¸­ä½¿ç”¨
const hasPermission = computed(() => {
  return userStore.hasRole(['R0001', 'R0002'])
})
</script>
```

### 2.5 è·¯ç”±ç®¡ç†

#### Vue Router 4.6.3

**è·¯ç”±é…ç½®**
```typescript
// router/index.ts
import { createRouter, createWebHistory } from 'vue-router'

const routes = [
  {
    path: '/login',
    component: () => import('@/views/login/index.vue'),
    meta: {
      title: 'ç™»å½•',
      hidden: true  // ä¸åœ¨èœå•ä¸­æ˜¾ç¤º
    }
  },
  {
    path: '/',
    component: () => import('@/layouts/index.vue'),
    redirect: '/index',
    meta: { title: 'é¦–é¡µ' },
    children: [
      {
        path: 'index',
        name: 'Index',
        component: () => import('@/views/dashboard/index.vue'),
        meta: {
          title: 'é¦–é¡µ',
          icon: 'HomeFilled',
          affix: true  // å›ºå®šåœ¨æ ‡ç­¾é¡µ
        }
      }
    ]
  }
]

const router = createRouter({
  history: createWebHistory(),
  routes
})

// è·¯ç”±å®ˆå«
router.beforeEach((to, from, next) => {
  const userStore = useUserStore()

  // è®¾ç½®é¡µé¢æ ‡é¢˜
  document.title = to.meta.title as string

  // æ£€æŸ¥ç™»å½•çŠ¶æ€
  if (to.path !== '/login' && !userStore.isAuthenticated) {
    next('/login')
  } else {
    next()
  }
})

export default router
```

**è·¯ç”±è·³è½¬**
```vue
<script setup lang="ts">
import { useRouter } from 'vue-router'

const router = useRouter()

// å£°æ˜å¼å¯¼èˆª
// <router-link to="/about">å…³äº</router-link>

// ç¼–ç¨‹å¼å¯¼èˆª
const goToProject = () => {
  router.push('/project')
}

const goToDetail = (id: number) => {
  router.push({ path: `/detail/${id}` })
  // æˆ–è€…
  router.push({ name: 'Detail', params: { id } })
}

const goBack = () => {
  router.back()
}
</script>
```

### 2.6 HTTP å®¢æˆ·ç«¯

#### Axios 1.13.2

**å°è£… HTTP è¯·æ±‚**
```typescript
// common/http.ts
import axios, { type AxiosInstance, type AxiosRequestConfig } from 'axios'
import { ElMessage } from 'element-plus'

class Http {
  private instance: AxiosInstance

  constructor(config: AxiosRequestConfig) {
    this.instance = axios.create(config)
    this.interceptors()
  }

  // è¯·æ±‚æ‹¦æˆªå™¨
  private interceptors() {
    // è¯·æ±‚æ‹¦æˆª
    this.instance.interceptors.request.use(
      (config) => {
        // è‡ªåŠ¨æºå¸¦ token
        const token = sessionStorage.getItem('token')
        if (token) {
          config.headers['Authorization'] = 'Bearer ' + token
        }
        return config
      },
      (error) => {
        return Promise.reject(error)
      }
    )

    // å“åº”æ‹¦æˆª
    this.instance.interceptors.response.use(
      (response) => {
        const { data } = response

        // å¤„ç†ä¸šåŠ¡é”™è¯¯ç 
        if (data.code !== 200) {
          ElMessage.error(data.message || 'è¯·æ±‚å¤±è´¥')
          return Promise.reject(new Error(data.message))
        }

        return data
      },
      (error) => {
        // å¤„ç† HTTP é”™è¯¯
        if (error.response) {
          const status = error.response.status
          const msgMap: Record<number, string> = {
            400: 'è¯·æ±‚é”™è¯¯',
            401: 'æœªæˆæƒï¼Œè¯·ç™»å½•',
            403: 'æ‹’ç»è®¿é—®',
            404: 'è¯·æ±‚èµ„æºä¸å­˜åœ¨',
            500: 'æœåŠ¡å™¨é”™è¯¯'
          }
          ElMessage.error(msgMap[status] || 'è¯·æ±‚å¤±è´¥')
        }
        return Promise.reject(error)
      }
    )
  }

  // å°è£…è¯·æ±‚æ–¹æ³•
  get<T = any>(url: string, params?: any) {
    return this.instance.get<T>(url, { params })
  }

  post<T = any>(url: string, data?: any) {
    return this.instance.post<T>(url, data)
  }

  put<T = any>(url: string, data?: any) {
    return this.instance.put<T>(url, data)
  }

  delete<T = any>(url: string, params?: any) {
    return this.instance.delete<T>(url, { params })
  }
}

export default new Http({
  baseURL: import.meta.env.VITE_API_BASE_URL,
  timeout: 30000
})
```

**API å®šä¹‰**
```typescript
// api/project.ts
import http from '@/common/http'

// å®šä¹‰æ¥å£è¿”å›ç±»å‹
interface Result<T = any> {
  code: string
  message: string
  data: T
}

// å®šä¹‰è¯·æ±‚å‚æ•°ç±»å‹
interface ProjectListParams {
  pageNumber: number
  pageSize: number
  projectName?: string
  involvedRegions?: string
  oneselfFlg?: boolean
}

// å®šä¹‰è¿”å›æ•°æ®ç±»å‹
interface Project {
  projectsId: number
  projectName: string
  projectStatus: string
  applicant: string
}

interface PageResult<T> {
  records: T[]
  total: number
  current: number
  size: number
}

// API æ–¹æ³•
export const getProjectList = (params: ProjectListParams) => {
  return http.post<Result<PageResult<Project>>>(
    '/biddingProjects/pageBiddingProjects',
    params
  )
}

export const getProjectDetail = (id: number) => {
  return http.get<Result<Project>>(`/biddingProjects/getProjectDetail/${id}`)
}
```

**åœ¨ç»„ä»¶ä¸­ä½¿ç”¨**
```vue
<script setup lang="ts">
import { ref, onMounted } from 'vue'
import { getProjectList } from '@/api/project'
import type { Project } from '@/api/project'

const projectList = ref<Project[]>([])
const loading = ref(false)

const loadProjects = async () => {
  loading.value = true
  try {
    const res = await getProjectList({
      pageNumber: 1,
      pageSize: 10
    })
    projectList.value = res.data.records
  } catch (error) {
    console.error('åŠ è½½å¤±è´¥:', error)
  } finally {
    loading.value = false
  }
}

onMounted(() => {
  loadProjects()
})
</script>
```

---

## ä¸‰ã€é¡¹ç›®ç»“æ„ä¸é…ç½®

### 3.1 ç›®å½•ç»“æ„

```
frontend/
â”œâ”€â”€ public/                 # é™æ€èµ„æº
â”‚   â””â”€â”€ favicon.ico
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ api/               # API æ¥å£å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ auth.ts
â”‚   â”‚   â”œâ”€â”€ project.ts
â”‚   â”‚   â”œâ”€â”€ product.ts
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ assets/            # é™æ€èµ„æºï¼ˆå›¾ç‰‡ã€å­—ä½“ç­‰ï¼‰
â”‚   â”œâ”€â”€ common/            # å…¬å…±æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ component/     # å…¬å…±ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ models/        # æ•°æ®æ¨¡å‹
â”‚   â”‚   â””â”€â”€ http.ts        # Axios å°è£…
â”‚   â”œâ”€â”€ components/        # ä¸šåŠ¡ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ VabNav/        # é¡¶éƒ¨å¯¼èˆª
â”‚   â”‚   â”œâ”€â”€ VabSide/       # ä¾§è¾¹æ 
â”‚   â”‚   â”œâ”€â”€ VabTabs/       # æ ‡ç­¾é¡µ
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ config/            # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ constants/         # å¸¸é‡å®šä¹‰
â”‚   â”œâ”€â”€ layouts/           # å¸ƒå±€ç»„ä»¶
â”‚   â”œâ”€â”€ mocks/             # Mock æ•°æ®
â”‚   â”œâ”€â”€ router/            # è·¯ç”±é…ç½®
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ stores/            # Pinia çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ user.ts
â”‚   â”‚   â”œâ”€â”€ tabsBar.ts
â”‚   â”‚   â””â”€â”€ dict.ts
â”‚   â”œâ”€â”€ styles/            # å…¨å±€æ ·å¼
â”‚   â”‚   â”œâ”€â”€ index.scss
â”‚   â”‚   â””â”€â”€ variables.scss # SCSS å˜é‡
â”‚   â”œâ”€â”€ utils/             # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ views/             # é¡µé¢è§†å›¾
â”‚   â”‚   â”œâ”€â”€ dashboard/     # é¦–é¡µ
â”‚   â”‚   â”œâ”€â”€ login/         # ç™»å½•é¡µ
â”‚   â”‚   â”œâ”€â”€ projects/      # é¡¹ç›®ç®¡ç†
â”‚   â”‚   â””â”€â”€ resource/      # èµ„æºç®¡ç†
â”‚   â”œâ”€â”€ App.vue            # æ ¹ç»„ä»¶
â”‚   â””â”€â”€ main.ts            # å…¥å£æ–‡ä»¶
â”œâ”€â”€ .env.development       # å¼€å‘ç¯å¢ƒå˜é‡
â”œâ”€â”€ .env.production        # ç”Ÿäº§ç¯å¢ƒå˜é‡
â”œâ”€â”€ .env.qa                # QA ç¯å¢ƒå˜é‡
â”œâ”€â”€ index.html             # HTML æ¨¡æ¿
â”œâ”€â”€ package.json           # é¡¹ç›®ä¾èµ–
â”œâ”€â”€ tsconfig.json          # TypeScript é…ç½®
â””â”€â”€ vite.config.ts         # Vite é…ç½®
```

### 3.2 ç¯å¢ƒé…ç½®

**å¼€å‘ç¯å¢ƒ**ï¼ˆ.env.developmentï¼‰
```env
VITE_API_BASE_URL=http://localhost:9900/bidding
VITE_SSO_REDIRECT_URL=http://localhost:9900/bidding/oauth2/authorization/bidding-client
VITE_APP_ENV=development
```

**ç”Ÿäº§ç¯å¢ƒ**ï¼ˆ.env.productionï¼‰
```env
VITE_API_BASE_URL=/bidding/
VITE_SSO_REDIRECT_URL=https://bid.pha.bayer.cn/bidding/oauth2/authorization/bidding-client
VITE_APP_ENV=production
```

**ä½¿ç”¨ç¯å¢ƒå˜é‡**
```typescript
const apiUrl = import.meta.env.VITE_API_BASE_URL
const isDev = import.meta.env.DEV
const isProd = import.meta.env.PROD
```

### 3.3 TypeScript é…ç½®

**tsconfig.app.json**
```json
{
  "extends": "@vue/tsconfig/tsconfig.dom.json",
  "include": ["env.d.ts", "src/**/*", "src/**/*.vue"],
  "exclude": ["src/**/__tests__/*"],
  "compilerOptions": {
    "composite": true,
    "tsBuildInfoFile": "./node_modules/.tmp/tsconfig.app.tsbuildinfo",
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"]  // è·¯å¾„æ˜ å°„
    }
  }
}
```

---

## å››ã€æ ¸å¿ƒæ¦‚å¿µä¸åŸç†

### 4.1 Vue 3 æ ¸å¿ƒæ¦‚å¿µ

#### å“åº”å¼ç³»ç»Ÿ

**ref vs reactive**
```vue
<script setup lang="ts">
import { ref, reactive } from 'vue'

// ref - ç”¨äºåŸºæœ¬ç±»å‹
const count = ref(0)
count.value++  // éœ€è¦ .value

// reactive - ç”¨äºå¯¹è±¡ç±»å‹
const user = reactive({
  name: 'å¼ ä¸‰',
  age: 25
})
user.name = 'æå››'  // ç›´æ¥è®¿é—®

// ä½¿ç”¨ ref çš„å¯¹è±¡
const user2 = ref({
  name: 'ç‹äº”',
  age: 30
})
user2.value.name = 'èµµå…­'  // éœ€è¦ .value
</script>
```

**ä»€ä¹ˆæ—¶å€™ç”¨ refï¼Œä»€ä¹ˆæ—¶å€™ç”¨ reactiveï¼Ÿ**
- åŸºæœ¬ç±»å‹ï¼ˆstring, number, booleanï¼‰â†’ ç”¨ `ref`
- å¯¹è±¡ç±»å‹ï¼ˆObject, Arrayï¼‰â†’ ç”¨ `reactive` æˆ– `ref`
- éœ€è¦æ•´ä½“æ›¿æ¢å¯¹è±¡ â†’ ç”¨ `ref`

#### è®¡ç®—å±æ€§ vs ä¾¦å¬å™¨

**computedï¼ˆè®¡ç®—å±æ€§ï¼‰**
```vue
<script setup lang="ts">
import { ref, computed } from 'vue'

const firstName = ref('å¼ ')
const lastName = ref('ä¸‰')

// è®¡ç®—å±æ€§ï¼ˆæœ‰ç¼“å­˜ï¼‰
const fullName = computed(() => {
  return firstName.value + lastName.value
})

// å¯å†™çš„è®¡ç®—å±æ€§
const fullName2 = computed({
  get: () => firstName.value + lastName.value,
  set: (value) => {
    [firstName.value, lastName.value] = value.split(' ')
  }
})
</script>
```

**watchï¼ˆä¾¦å¬å™¨ï¼‰**
```vue
<script setup lang="ts">
import { ref, watch } from 'vue'

const count = ref(0)
const user = ref({ name: 'å¼ ä¸‰', age: 25 })

// ä¾¦å¬å•ä¸ªæº
watch(count, (newVal, oldVal) => {
  console.log(`count ä» ${oldVal} å˜ä¸º ${newVal}`)
})

// ä¾¦å¬å¤šä¸ªæº
watch([firstName, lastName], ([newFirst, newLast]) => {
  console.log('å§“åå˜åŒ–:', newFirst, newLast)
})

// æ·±åº¦ä¾¦å¬
watch(user, (newVal) => {
  console.log('user å˜åŒ–:', newVal)
}, { deep: true })

// ç«‹å³æ‰§è¡Œ
watch(count, (val) => {
  console.log('count:', val)
}, { immediate: true })
</script>
```

**computed vs watchï¼Ÿ**
- `computed`ï¼šæœ‰ç¼“å­˜ï¼Œé€‚åˆè®¡ç®—æ´¾ç”Ÿå€¼
- `watch`ï¼šæ— ç¼“å­˜ï¼Œé€‚åˆæ‰§è¡Œå‰¯ä½œç”¨ï¼ˆå¦‚ API è¯·æ±‚ï¼‰

#### ç”Ÿå‘½å‘¨æœŸ

```vue
<script setup lang="ts">
import {
  onBeforeMount,
  onMounted,
  onBeforeUpdate,
  onUpdated,
  onBeforeUnmount,
  onUnmounted
} from 'vue'

// æŒ‚è½½å‰
onBeforeMount(() => {
  console.log('ç»„ä»¶å³å°†æŒ‚è½½')
})

// æŒ‚è½½å
onMounted(() => {
  console.log('ç»„ä»¶å·²æŒ‚è½½')
  // åœ¨è¿™é‡Œè®¿é—® DOM
  document.querySelector('.title')
})

// æ›´æ–°å‰
onBeforeUpdate(() => {
  console.log('ç»„ä»¶å³å°†æ›´æ–°')
})

// æ›´æ–°å
onUpdated(() => {
  console.log('ç»„ä»¶å·²æ›´æ–°')
})

// å¸è½½å‰
onBeforeUnmount(() => {
  console.log('ç»„ä»¶å³å°†å¸è½½')
})

// å¸è½½å
onUnmounted(() => {
  console.log('ç»„ä»¶å·²å¸è½½')
  // æ¸…ç†å®šæ—¶å™¨ã€äº‹ä»¶ç›‘å¬ç­‰
})
</script>
```

### 4.2 ç»„ä»¶é€šä¿¡

#### çˆ¶å­ç»„ä»¶é€šä¿¡

**çˆ¶ä¼ å­ï¼ˆPropsï¼‰**
```vue
<!-- çˆ¶ç»„ä»¶ -->
<template>
  <ChildComponent
    :user-info="userInfo"
    :is-editable="true"
    @update="handleUpdate"
  />
</template>

<script setup lang="ts">
const userInfo = ref({
  name: 'å¼ ä¸‰',
  age: 25
})

const handleUpdate = (newData: any) => {
  console.log('æ”¶åˆ°å­ç»„ä»¶æ›´æ–°:', newData)
}
</script>

<!-- å­ç»„ä»¶ -->
<script setup lang="ts">
const props = defineProps<{
  userInfo: { name: string; age: number }
  isEditable: boolean
}>()

const emit = defineEmits<{
  (e: 'update', data: any): void
}>()

// å‘é€äº‹ä»¶ç»™çˆ¶ç»„ä»¶
const sendData = () => {
  emit('update', { name: 'æå››', age: 30 })
}
</script>
```

**å­ä¼ çˆ¶ï¼ˆEmitï¼‰**
```vue
<!-- å­ç»„ä»¶ -->
<template>
  <el-button @click="handleClick">ç‚¹å‡»æˆ‘</el-button>
</template>

<script setup lang="ts">
const emit = defineEmits<{
  (e: 'click', count: number): void
  (e: 'submit', data: any): void
}>()

const handleClick = () => {
  emit('click', 1)
}
</script>

<!-- çˆ¶ç»„ä»¶ -->
<template>
  <ChildComponent @click="handleChildClick" />
</template>

<script setup lang="ts">
const handleChildClick = (count: number) => {
  console.log('å­ç»„ä»¶è¢«ç‚¹å‡»äº†', count)
}
</script>
```

#### Ref æš´éœ²æ–¹æ³•

```vue
<!-- å­ç»„ä»¶ -->
<script setup lang="ts">
const form = reactive({
  name: '',
  email: ''
})

const validate = async () => {
  // éªŒè¯é€»è¾‘
  return true
}

const reset = () => {
  form.name = ''
  form.email = ''
}

// æš´éœ²æ–¹æ³•ç»™çˆ¶ç»„ä»¶
defineExpose({
  validate,
  reset,
  form
})
</script>

<!-- çˆ¶ç»„ä»¶ -->
<template>
  <ChildComponent ref="childRef" />
  <el-button @click="handleValidate">éªŒè¯å­ç»„ä»¶è¡¨å•</el-button>
</template>

<script setup lang="ts">
const childRef = ref<InstanceType<typeof ChildComponent>>()

const handleValidate = async () => {
  const isValid = await childRef.value?.validate()
  if (isValid) {
    console.log('éªŒè¯é€šè¿‡')
  }
}
</script>
```

#### ä¾èµ–æ³¨å…¥ï¼ˆProvide/Injectï¼‰

```vue
<!-- ç¥–å…ˆç»„ä»¶ -->
<script setup lang="ts>
import { provide } from 'vue'

const theme = ref('light')

const toggleTheme = () => {
  theme.value = theme.value === 'light' ? 'dark' : 'light'
}

provide('theme', {
  theme,
  toggleTheme
})
</script>

<!-- åä»£ç»„ä»¶ -->
<script setup lang="ts">
import { inject } from 'vue'

const { theme, toggleTheme } = inject('theme')!
</script>
```

### 4.3 è·¯ç”±åŸç†

#### è·¯ç”±å®ˆå«

```typescript
// å…¨å±€å‰ç½®å®ˆå«
router.beforeEach((to, from, next) => {
  console.log('ä»', from.path, 'åˆ°', to.path)

  const userStore = useUserStore()

  // æ£€æŸ¥ç™»å½•çŠ¶æ€
  if (to.path !== '/login' && !userStore.isAuthenticated) {
    next('/login')
  } else {
    next()
  }
})

// å…¨å±€åç½®é’©å­
router.afterEach((to, from) => {
  document.title = to.meta.title as string
})
```

#### è·¯ç”±å…ƒä¿¡æ¯

```typescript
{
  path: '/project',
  component: Layout,
  meta: {
    title: 'é¡¹ç›®ç®¡ç†',
    icon: 'FolderOpened',
    hidden: false,        // æ˜¯å¦åœ¨èœå•ä¸­éšè—
    requiresAuth: true,   // æ˜¯å¦éœ€è¦ç™»å½•
    affix: true,          // æ˜¯å¦å›ºå®šåœ¨æ ‡ç­¾é¡µ
    noKeepAlive: false    // æ˜¯å¦ä¸ç¼“å­˜
  }
}
```

---

## äº”ã€ç•Œé¢å®ç°è¯¦è§£

### 5.1 ç™»å½•é¡µé¢å®ç°

**æ–‡ä»¶ä½ç½®**ï¼š`src/views/login/index.vue`

**åŠŸèƒ½ç‰¹ç‚¹**ï¼š
- âœ… åŒç™»å½•æ¨¡å¼ï¼ˆè´¦å·å¯†ç  + Azure AD SSOï¼‰
- âœ… å¯†ç åŠ å¯†ï¼ˆSHA256ï¼‰
- âœ… è¡¨å•éªŒè¯
- âœ… è®°ä½å¯†ç 

**å®Œæ•´ä»£ç **ï¼š
```vue
<template>
  <div class="login-container">
    <div class="login-box">
      <div class="login-header">
        <img src="@/assets/logo.png" alt="Logo" />
        <h2>æ‹œè€³æ™ºèƒ½æ‹›é‡‡å¹³å°</h2>
      </div>

      <el-form
        ref="loginFormRef"
        :model="userInfo"
        :rules="rules"
        class="login-form"
      >
        <el-form-item prop="email">
          <el-input
            v-model="userInfo.email"
            placeholder="è¯·è¾“å…¥ç”¨æˆ·å"
            prefix-icon="User"
            clearable
          />
        </el-form-item>

        <el-form-item prop="password">
          <el-input
            v-model="userInfo.password"
            type="password"
            show-password
            placeholder="è¯·è¾“å…¥å¯†ç "
            prefix-icon="Lock"
            @keyup.enter="handleSubmit"
          />
        </el-form-item>

        <el-form-item>
          <el-checkbox v-model="rememberMe">è®°ä½å¯†ç </el-checkbox>
        </el-form-item>

        <el-form-item>
          <el-button
            type="primary"
            :loading="loading"
            class="login-button"
            @click="handleSubmit"
          >
            ç™»å½•
          </el-button>
        </el-form-item>

        <el-form-item>
          <el-button
            type="success"
            :loading="loading"
            class="login-button"
            @click="handleAzureSSO"
          >
            Azure AD ç™»å½•
          </el-button>
        </el-form-item>
      </el-form>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, reactive, onMounted } from 'vue'
import { useRouter, useRoute } from 'vue-router'
import { ElMessage } from 'element-plus'
import { sha256 } from 'js-sha256'
import { useUserStore } from '@/stores/user'

const router = useRouter()
const route = useRoute()
const userStore = useUserStore()

const loginFormRef = ref()
const loading = ref(false)
const rememberMe = ref(false)

const userInfo = reactive({
  email: '',
  password: ''
})

const rules = {
  email: [
    { required: true, message: 'è¯·è¾“å…¥ç”¨æˆ·å', trigger: 'blur' }
  ],
  password: [
    { required: true, message: 'è¯·è¾“å…¥å¯†ç ', trigger: 'blur' },
    { min: 6, message: 'å¯†ç è‡³å°‘6ä½', trigger: 'blur' }
  ]
}

// è´¦å·å¯†ç ç™»å½•
const handleSubmit = async () => {
  if (!loginFormRef.value) return

  try {
    await loginFormRef.value.validate()
    loading.value = true

    // SHA256 åŠ å¯†å¯†ç 
    const encryptedPassword = sha256(userInfo.password)

    // è°ƒç”¨ç™»å½•æ¥å£
    await userStore.login({
      email: userInfo.email,
      password: encryptedPassword
    })

    ElMessage.success('ç™»å½•æˆåŠŸ')

    // è·³è½¬åˆ°é¦–é¡µæˆ–é‡å®šå‘é¡µé¢
    const redirect = (route.query.redirect as string) || '/index'
    await router.push(redirect)
  } catch (error: any) {
    ElMessage.error(error.message || 'ç™»å½•å¤±è´¥')
  } finally {
    loading.value = false
  }
}

// Azure AD SSO ç™»å½•
const handleAzureSSO = () => {
  const ssoUrl = import.meta.env.VITE_SSO_REDIRECT_URL
  window.location.href = ssoUrl
}

// SSO å›è°ƒå¤„ç†
onMounted(async () => {
  const ssoToken = route.query.token as string
  if (ssoToken) {
    try {
      await userStore.ssoLoginByToken(ssoToken)
      ElMessage.success('SSO ç™»å½•æˆåŠŸ')
      await router.push({ path: '/index' })
    } catch (error: any) {
      ElMessage.error(error.message || 'SSO ç™»å½•å¤±è´¥')
    }
  }
})
</script>

<style lang="scss" scoped>
.login-container {
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}

.login-box {
  width: 400px;
  padding: 40px;
  background: white;
  border-radius: 10px;
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
}

.login-header {
  text-align: center;
  margin-bottom: 30px;

  img {
    width: 80px;
    height: 80px;
    margin-bottom: 10px;
  }

  h2 {
    font-size: 24px;
    color: #333;
  }
}

.login-form {
  .login-button {
    width: 100%;
  }
}
</style>
```

**å®ç°è¦ç‚¹**ï¼š

1. **å¯†ç åŠ å¯†**
```typescript
import { sha256 } from 'js-sha256'

const encryptedPassword = sha256(userInfo.password)
```

2. **è¡¨å•éªŒè¯**
```typescript
const rules = {
  email: [
    { required: true, message: 'è¯·è¾“å…¥ç”¨æˆ·å', trigger: 'blur' }
  ],
  password: [
    { required: true, message: 'è¯·è¾“å…¥å¯†ç ', trigger: 'blur' },
    { min: 6, message: 'å¯†ç è‡³å°‘6ä½', trigger: 'blur' }
  ]
}

await loginFormRef.value.validate()
```

3. **SSO ç™»å½•æµç¨‹**
```
ç”¨æˆ·ç‚¹å‡» "Azure AD ç™»å½•"
  â†“
è·³è½¬åˆ° Azure AD ç™»å½•é¡µ
  â†“
ç”¨æˆ·è¾“å…¥å‡­æ®
  â†“
Azure AD å›è°ƒå‰ç«¯ï¼Œæºå¸¦ token
  â†“
å‰ç«¯è°ƒç”¨ ssoLoginByToken(token)
  â†“
ç™»å½•æˆåŠŸï¼Œè·³è½¬é¦–é¡µ
```

### 5.2 é¡¹ç›®åˆ—è¡¨é¡µå®ç°

**æ–‡ä»¶ä½ç½®**ï¼š`src/views/projects/project-applications/index.vue`

**åŠŸèƒ½ç‰¹ç‚¹**ï¼š
- âœ… é«˜çº§æœç´¢ï¼ˆå±•å¼€/æ”¶èµ·ï¼‰
- âœ… åˆ†é¡µè¡¨æ ¼
- âœ… æƒé™æ§åˆ¶
- âœ… ç»Ÿè®¡å¼¹çª—
- âœ… Keep-Alive ç¼“å­˜

**æ ¸å¿ƒä»£ç **ï¼š

```vue
<template>
  <div class="project-applications">
    <!-- æœç´¢åŒºåŸŸ -->
    <div class="search-section">
      <el-button
        :icon="isSearchCollapsed ? ArrowDown : ArrowUp"
        @click="toggleSearchCollapse"
      >
        {{ isSearchCollapsed ? 'å±•å¼€æœç´¢' : 'æ”¶èµ·æœç´¢' }}
      </el-button>

      <el-collapse-transition>
        <div v-show="!isSearchCollapsed">
          <QueryForm
            ref="queryFormRef"
            @search="handleSearch"
            @reset="handleReset"
          />
        </div>
      </el-collapse-transition>
    </div>

    <!-- æ“ä½œæŒ‰é’®åŒºåŸŸ -->
    <div class="action-section">
      <el-button
        v-if="canViewStatistics"
        :icon="DataAnalysis"
        @click="handleStatistics"
      >
        é¡¹ç›®ç»Ÿè®¡
      </el-button>

      <el-button
        v-if="canCreateProject"
        type="primary"
        :icon="Plus"
        @click="handleCreate"
      >
        åˆ›å»ºç”³è¯·
      </el-button>

      <el-switch
        v-model="onlyShowMyTasks"
        active-text="ä»…çœ‹å¾…æˆ‘å¤„ç†"
        @change="handleToggleMyTasks"
      />
    </div>

    <!-- é¡¹ç›®åˆ—è¡¨ -->
    <ListResult
      ref="listResultRef"
      :oneself-flg="onlyShowMyTasks"
    />
  </div>
</template>

<script setup lang="ts">
import { ref, computed, onActivated } from 'vue'
import { useRouter } from 'vue-router'
import { useUserStore } from '@/stores/user'
import { ArrowDown, ArrowUp, DataAnalysis, Plus } from '@element-plus/icons-vue'
import QueryForm from './QueryForm.vue'
import ListResult from './ListResult.vue'

const router = useRouter()
const userStore = useUserStore()

const queryFormRef = ref()
const listResultRef = ref()
const isSearchCollapsed = ref(false)
const onlyShowMyTasks = ref(false)

// æƒé™åˆ¤æ–­
const menuList = userStore.user?.menuList || []
const projectMenu = menuList.find(item => item.menuCode === 'Project')
const btnList = projectMenu?.subMenuList?.map(item => item.menuCode) || []

const canViewStatistics = computed(() =>
  btnList.includes('Project_Statistics')
)

const canCreateProject = computed(() => {
  const roleCode = userStore.user?.roles[0]?.roleCode
  return roleCode !== 'R0002'  // R0002 æ˜¯æ™®é€šç”¨æˆ·
})

// å±•å¼€/æ”¶èµ·æœç´¢
const toggleSearchCollapse = () => {
  isSearchCollapsed.value = !isSearchCollapsed.value
}

// æœç´¢
const handleSearch = (params: any) => {
  if (listResultRef.value) {
    listResultRef.value.setSearchParams(params)
    listResultRef.value.reload()
  }
}

// é‡ç½®
const handleReset = () => {
  if (queryFormRef.value) {
    queryFormRef.value.resetForm()
  }
}

// é¡¹ç›®ç»Ÿè®¡
const handleStatistics = () => {
  // æ‰“å¼€ç»Ÿè®¡å¼¹çª—
}

// åˆ›å»ºç”³è¯·
const handleCreate = () => {
  router.push({ path: 'document', query: { type: '4', state: 'creat' } })
}

// åˆ‡æ¢"ä»…çœ‹å¾…æˆ‘å¤„ç†"
const handleToggleMyTasks = () => {
  if (listResultRef.value) {
    listResultRef.value.reload()
  }
}

// Keep-Alive æ¿€æ´»æ—¶é‡æ–°åŠ è½½æ•°æ®
onActivated(() => {
  if (listResultRef.value) {
    const formData = queryFormRef.value?.getFormData()
    listResultRef.value.setSearchParams(formData)
    listResultRef.value.reload()
  }
})
</script>

<style lang="scss" scoped>
.project-applications {
  padding: $base-padding;

  .search-section {
    margin-bottom: 20px;
  }

  .action-section {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 20px;
  }
}
</style>
```

**QueryForm æŸ¥è¯¢è¡¨å•ç»„ä»¶**ï¼š

```vue
<template>
  <el-form :model="form" label-width="100px">
    <el-row :gutter="16">
      <el-col :span="8">
        <el-form-item label="é¡¹ç›®åç§°">
          <el-input v-model="form.projectName" clearable />
        </el-form-item>
      </el-col>

      <el-col :span="8">
        <el-form-item label="åœ°åŒº">
          <ProvincePicker v-model="form.regions" />
        </el-form-item>
      </el-col>

      <el-col :span="8">
        <el-form-item label="é€šç”¨å">
          <el-select
            v-model="form.commonName"
            filterable
            clearable
          >
            <el-option
              v-for="item in commonNameOptions"
              :key="item"
              :label="item"
              :value="item"
            />
          </el-select>
        </el-form-item>
      </el-col>
    </el-row>

    <el-row :gutter="16">
      <el-col :span="8">
        <el-form-item label="é¡¹ç›®ç±»å‹">
          <el-select v-model="form.projectType" multiple clearable>
            <el-option label="å›½è°ˆ" value="1" />
            <el-option label="å¸¦é‡é‡‡è´­" value="2" />
            <el-option label="æ–°å¢æŒ‚ç½‘" value="3" />
          </el-select>
        </el-form-item>
      </el-col>

      <el-col :span="8">
        <el-form-item label="é¡¹ç›®çŠ¶æ€">
          <el-select v-model="form.projectStatus" multiple clearable>
            <el-option label="è‰ç¨¿" value="1" />
            <el-option label="è¿›è¡Œä¸­" value="2" />
            <el-option label="å·²å®Œæˆ" value="3" />
          </el-select>
        </el-form-item>
      </el-col>
    </el-row>

    <el-row>
      <el-col :span="8" :offset="16">
        <el-button @click="handleReset">é‡ç½®</el-button>
        <el-button type="primary" @click="handleSearch">æŸ¥è¯¢</el-button>
      </el-col>
    </el-row>
  </el-form>
</template>

<script setup lang="ts">
import { reactive } from 'vue'

const emit = defineEmits<{
  (e: 'search', payload: any): void
  (e: 'reset'): void
}>()

const form = reactive({
  projectName: '',
  regions: [] as string[],
  commonName: '',
  projectType: [] as string[],
  projectStatus: [] as string[]
})

const commonNameOptions = ref<string[]>([])

const handleSearch = () => {
  emit('search', { ...form })
}

const handleReset = () => {
  form.projectName = ''
  form.regions = []
  form.commonName = ''
  form.projectType = []
  form.projectStatus = []
  emit('reset')
}

const resetForm = () => {
  handleReset()
}

const getFormData = () => {
  return { ...form }
}

defineExpose({
  resetForm,
  getFormData
})
</script>
```

**ListResult åˆ—è¡¨ç»“æœç»„ä»¶**ï¼š

```vue
<template>
  <TablePage
    ref="tablePageRef"
    :load-data="loadData"
    :auto-load="false"
  >
    <el-table-column prop="region" label="åœ°åŒº" width="150" />
    <el-table-column prop="projectName" label="é¡¹ç›®åç§°" min-width="200" />
    <el-table-column prop="projectSubType" label="é¡¹ç›®ç±»å‹" width="120" />
    <el-table-column prop="applicant" label="ç”³è¯·äºº" width="120" />
    <el-table-column prop="approvalDate" label="ç«‹é¡¹æ—¶é—´" width="180" />
    <el-table-column label="å­æµç¨‹ç»Ÿè®¡" width="200">
      <template #default="{ row }">
        <SubProcessStats :stats="row.subProcessStats" />
      </template>
    </el-table-column>
    <el-table-column label="é¡¹ç›®çŠ¶æ€" width="100">
      <template #default="{ row }">
        <el-tag :type="getStatusType(row.projectStatus)">
          {{ row.projectStatus }}
        </el-tag>
      </template>
    </el-table-column>
    <el-table-column label="æ“ä½œ" width="150" fixed="right">
      <template #default="{ row }">
        <el-icon
          :size="20"
          color="#409eff"
          @click="handleView(row)"
        >
          <Search />
        </el-icon>
        <el-link type="primary" @click="handleMore(row)">
          æ›´å¤š
        </el-link>
      </template>
    </el-table-column>
  </TablePage>
</template>

<script setup lang="ts">
import { ref } from 'vue'
import { useRouter } from 'vue-router'
import { ElTag, ElIcon, ElLink } from 'element-plus'
import { Search } from '@element-plus/icons-vue'
import TablePage from '@/common/component/TablePage.vue'
import SubProcessStats from './SubProcessStats.vue'
import { getProjectList } from '@/api/project'

interface Props {
  oneselfFlg?: boolean
}

const props = defineProps<Props>()
const router = useRouter()

const tablePageRef = ref()
const searchParams = ref<any>({})

// åŠ è½½æ•°æ®å‡½æ•°
const loadData = async ({ page, pageSize }: { page: number; pageSize: number }) => {
  const apiParams = {
    pageNumber: page,
    pageSize: pageSize,
    projectName: searchParams.value.projectName,
    involvedRegions: searchParams.value.regions?.join(','),
    commonName: searchParams.value.commonName,
    projectTypeList: searchParams.value.projectType,
    projectStatusList: searchParams.value.projectStatus,
    oneselfFlg: props.oneselfFlg
  }

  const response = await getProjectList(apiParams)

  return {
    list: response.data.records.map((item: any) => ({
      projectsId: item.projectsId,
      projectName: item.projectName,
      projectStatus: item.projectStatusDis,
      region: item.involvedRegionsDis,
      projectSubType: item.projectSubTypeDis,
      applicant: item.applicantUserName,
      approvalDate: item.applicationTime,
      subProcessStats: item.subProcessStats
    })),
    pageInfo: {
      pageNum: response.data.current,
      pageSize: response.data.size,
      total: response.data.total
    }
  }
}

// æŸ¥çœ‹è¯¦æƒ…
const handleView = (row: any) => {
  router.push({
    path: '/projects/detail',
    query: { projectId: row.projectsId }
  })
}

// æ›´å¤šæ“ä½œ
const handleMore = (row: any) => {
  // æ‰“å¼€æ›´å¤šæ“ä½œèœå•
}

// è·å–çŠ¶æ€æ ‡ç­¾ç±»å‹
const getStatusType = (status: string) => {
  const map: Record<string, string> = {
    'è‰ç¨¿': 'info',
    'è¿›è¡Œä¸­': 'warning',
    'å·²å®Œæˆ': 'success'
  }
  return map[status] || 'info'
}

// è®¾ç½®æœç´¢å‚æ•°
const setSearchParams = (params: any) => {
  searchParams.value = params
}

// é‡æ–°åŠ è½½
const reload = () => {
  tablePageRef.value?.reloadData(true)
}

defineExpose({
  setSearchParams,
  reload
})
</script>
```

**å®ç°è¦ç‚¹**ï¼š

1. **çˆ¶å­ç»„ä»¶é€šä¿¡**
```vue
<!-- çˆ¶ç»„ä»¶ -->
<QueryForm
  ref="queryFormRef"
  @search="handleSearch"
/>

<script>
const handleSearch = (params) => {
  listResultRef.value.setSearchParams(params)
  listResultRef.value.reload()
}
</script>

<!-- å­ç»„ä»¶ -->
<script>
const emit = defineEmits<{
  (e: 'search', payload: any): void
}>()

const handleSearch = () => {
  emit('search', { ...form })
}
</script>
```

2. **Ref æš´éœ²æ–¹æ³•**
```vue
<!-- å­ç»„ä»¶ -->
<script>
const resetForm = () => {
  // é‡ç½®è¡¨å•
}

defineExpose({
  resetForm,
  getFormData
})
</script>

<!-- çˆ¶ç»„ä»¶ -->
<script>
const queryFormRef = ref()

const handleReset = () => {
  queryFormRef.value?.resetForm()
}
</script>
```

3. **Keep-Alive ç¼“å­˜**
```vue
<!-- çˆ¶ç»„ä»¶ï¼ˆè·¯ç”±é…ç½®ï¼‰ -->
<router-view v-slot="{ Component }">
  <keep-alive>
    <component :is="Component" />
  </keep-alive>
</router-view>

<!-- å­ç»„ä»¶ -->
<script>
onActivated(() => {
  // æ¯æ¬¡æ¿€æ´»æ—¶é‡æ–°åŠ è½½æ•°æ®
  reload()
})
</script>
```

### 5.3 é¡¹ç›®è¯¦æƒ…é¡µå®ç°

**æ–‡ä»¶ä½ç½®**ï¼š`src/views/projects/detail/index.vue`

**åŠŸèƒ½ç‰¹ç‚¹**ï¼š
- âœ… æ˜¾ç¤ºé¡¹ç›®åŸºæœ¬ä¿¡æ¯
- âœ… å­æµç¨‹åˆ—è¡¨
- âœ… åˆ›å»ºæ–°ç”³è¯·
- âœ… ç»“æŸé¡¹ç›®
- âœ… æƒé™æ§åˆ¶

**æ ¸å¿ƒä»£ç **ï¼š

```vue
<template>
  <div class="project-detail">
    <!-- é¡¹ç›®å¤´éƒ¨ä¿¡æ¯ -->
    <ProjectHeader
      :project-data="projectData"
      :can-modify="canModify"
      :can-end="canEndProject"
      @modify="handleModify"
      @end-project="handleEndProject"
    />

    <!-- æ“ä½œåŒºåŸŸ -->
    <div class="action-section">
      <el-button
        v-if="canCreateApplication"
        type="primary"
        :icon="Plus"
        @click="handleCreateApplication"
      >
        åˆ›å»ºç”³è¯·
      </el-button>

      <el-input
        v-model="searchKeyword"
        placeholder="æœç´¢å­æµç¨‹"
        clearable
        @blur="handleSearch"
      >
        <template #suffix>
          <el-icon @click="handleSearch">
            <Search />
          </el-icon>
        </template>
      </el-input>
    </div>

    <!-- å­æµç¨‹åˆ—è¡¨ -->
    <SubProcessList
      ref="subProcessListRef"
      :project-id="projectId"
      :search-keyword="searchKeyword"
    />
  </div>
</template>

<script setup lang="ts">
import { ref, computed, onMounted } from 'vue'
import { useRoute, useRouter } from 'vue-router'
import { ElMessage, ElMessageBox } from 'element-plus'
import { Plus, Search } from '@element-plus/icons-vue'
import { useUserStore } from '@/stores/user'
import { getProjectDetail, closureProject } from '@/api/project'
import ProjectHeader from './ProjectHeader.vue'
import SubProcessList from './SubProcessList.vue'

const route = useRoute()
const router = useRouter()
const userStore = useUserStore()

const projectId = ref<string>(route.query.projectId as string)
const projectData = ref<any>(null)
const searchKeyword = ref('')
const subProcessListRef = ref()

// æƒé™åˆ¤æ–­
const role = userStore.user?.roles[0]
const userId = userStore.user?.userId

const canModify = computed(() => {
  return ['R0001', 'R0003'].includes(role?.roleCode)
})

const canEndProject = computed(() => {
  return userId.value === projectData.value?.applicantUserID &&
         ['1', '2'].includes(projectData.value?.projectStatus)
})

const canCreateApplication = computed(() => {
  return role?.roleCode !== 'R0002' &&
         userId.value === projectData.value?.applicantUserID &&
         ['1', '2'].includes(projectData.value?.projectStatus)
})

// åŠ è½½é¡¹ç›®è¯¦æƒ…
const loadProjectDetail = async () => {
  try {
    const res = await getProjectDetail(Number(projectId.value))
    projectData.value = res.data
  } catch (error) {
    ElMessage.error('åŠ è½½é¡¹ç›®è¯¦æƒ…å¤±è´¥')
  }
}

// ä¿®æ”¹é¡¹ç›®
const handleModify = () => {
  router.push({
    path: '/projects/document',
    query: { projectId: projectId.value, state: 'edit' }
  })
}

// ç»“æŸé¡¹ç›®
const handleEndProject = async () => {
  try {
    await ElMessageBox.confirm('ç¡®å®šè¦ç»“æŸè¯¥é¡¹ç›®å—ï¼Ÿ', 'æç¤º', {
      confirmButtonText: 'ç¡®å®š',
      cancelButtonText: 'å–æ¶ˆ',
      type: 'warning'
    })

    await closureProject(Number(projectId.value))
    ElMessage.success('é¡¹ç›®å·²ç»“æŸ')
    router.back()
  } catch (error: any) {
    if (error !== 'cancel') {
      ElMessage.error('æ“ä½œå¤±è´¥')
    }
  }
}

// åˆ›å»ºç”³è¯·
const handleCreateApplication = () => {
  router.push({
    path: '/projects/document',
    query: { projectId: projectId.value, type: '4', state: 'creat' }
  })
}

// æœç´¢å­æµç¨‹
const handleSearch = () => {
  if (subProcessListRef.value) {
    subProcessListRef.value.search(searchKeyword.value)
  }
}

onMounted(() => {
  loadProjectDetail()
})
</script>

<style lang="scss" scoped>
.project-detail {
  padding: $base-padding;

  .action-section {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin: 20px 0;
  }
}
</style>
```

**ProjectHeader é¡¹ç›®å¤´éƒ¨ç»„ä»¶**ï¼š

```vue
<template>
  <el-card class="project-header">
    <div class="header-content">
      <div class="project-info">
        <h2 class="project-name">
          {{ projectData?.projectName }}
          <el-tag
            v-if="projectData?.projectCategory"
            :type="getCategoryType(projectData.projectCategory)"
          >
            {{ getCategoryName(projectData.projectCategory) }}
          </el-tag>
        </h2>

        <el-descriptions :column="3" border>
          <el-descriptions-item label="é¡¹ç›®ç¼–å·">
            {{ projectData?.projectCode }}
          </el-descriptions-item>
          <el-descriptions-item label="é¡¹ç›®ç±»å‹">
            {{ projectData?.projectTypeDis }}
          </el-descriptions-item>
          <el-descriptions-item label="é¡¹ç›®çŠ¶æ€">
            <el-tag :type="getStatusType(projectData?.projectStatus)">
              {{ projectData?.projectStatusDis }}
            </el-tag>
          </el-descriptions-item>
          <el-descriptions-item label="ç”³è¯·äºº">
            {{ projectData?.applicantUserName }}
          </el-descriptions-item>
          <el-descriptions-item label="ç«‹é¡¹æ—¶é—´">
            {{ projectData?.applicationTime }}
          </el-descriptions-item>
          <el-descriptions-item label="å‚ä¸åœ°åŒº">
            {{ projectData?.involvedRegionsDis }}
          </el-descriptions-item>
        </el-descriptions>
      </div>

      <div class="header-actions">
        <el-button
          v-if="canModify"
          :icon="Edit"
          @click="handleModify"
        >
          ä¿®æ”¹
        </el-button>
        <el-button
          v-if="canEnd"
          type="danger"
          :icon="CircleClose"
          @click="handleEndProject"
        >
          ç»“æŸé¡¹ç›®
        </el-button>
      </div>
    </div>
  </el-card>
</template>

<script setup lang="ts">
import { Edit, CircleClose } from '@element-plus/icons-vue'

interface Props {
  projectData: any
  canModify: boolean
  canEnd: boolean
}

const props = defineProps<Props>()

const emit = defineEmits<{
  (e: 'modify'): void
  (e: 'end-project'): void
}>()

const handleModify = () => {
  emit('modify')
}

const handleEndProject = () => {
  emit('end-project')
}

const getCategoryType = (category: string) => {
  const map: Record<string, string> = {
    '1': 'success',  // ä¸­å¤®ç”³è¯·é¡¹ç›®
    '2': 'warning',  // ä¸­å¤®å…³è”åŒºåŸŸé¡¹ç›®
    '3': 'info'      // åŒºåŸŸé¡¹ç›®
  }
  return map[category] || 'info'
}

const getCategoryName = (category: string) => {
  const map: Record<string, string> = {
    '1': 'ä¸­å¤®ç”³è¯·é¡¹ç›®',
    '2': 'ä¸­å¤®å…³è”åŒºåŸŸé¡¹ç›®',
    '3': 'åŒºåŸŸé¡¹ç›®'
  }
  return map[category] || ''
}

const getStatusType = (status: string) => {
  const map: Record<string, string> = {
    '1': 'info',     // è‰ç¨¿
    '2': 'warning',  // è¿›è¡Œä¸­
    '3': 'success'   // å·²å®Œæˆ
  }
  return map[status] || 'info'
}
</script>

<style lang="scss" scoped>
.project-header {
  margin-bottom: 20px;

  .header-content {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;

    .project-info {
      flex: 1;

      .project-name {
        display: flex;
        align-items: center;
        gap: 10px;
        margin: 0 0 20px 0;
      }
    }

    .header-actions {
      display: flex;
      gap: 10px;
    }
  }
}
</style>
```

### 5.4 èµ„æ–™åº“é¡µé¢å®ç°

**æ–‡ä»¶ä½ç½®**ï¼š`src/views/resource/MaterialStore/index.vue`

**åŠŸèƒ½ç‰¹ç‚¹**ï¼š
- âœ… Tab æ ‡ç­¾é¡µåˆ‡æ¢
- âœ… æƒé™æ§åˆ¶æ˜¾ç¤º
- âœ… æœç´¢è¡¨å•æŠ˜å è”åŠ¨
- âœ… èµ„æ–™ä¸Šä¼ 
- âœ… èµ„æ–™åˆ—è¡¨å±•ç¤º

**æ ¸å¿ƒä»£ç **ï¼š

```vue
<template>
  <div class="material-store">
    <el-tabs v-model="activeTab" @tab-change="handleTabChange">
      <!-- æ ‡å‡†èµ„æ–™-äº§å“ -->
      <el-tab-pane
        v-if="hasProductPermission"
        name="product"
        label="æ ‡å‡†èµ„æ–™-äº§å“"
      >
        <ProductMaterial
          v-if="activeTab === 'product'"
          :is-search-collapsed="isSearchCollapsed"
        />
      </el-tab-pane>

      <!-- æ ‡å‡†èµ„æ–™-ä¼ä¸š -->
      <el-tab-pane
        v-if="hasEnterprisePermission"
        name="enterprise"
        label="æ ‡å‡†èµ„æ–™-ä¼ä¸š"
      >
        <EnterpriseMaterial
          v-if="activeTab === 'enterprise'"
          :is-search-collapsed="isSearchCollapsed"
        />
      </el-tab-pane>

      <!-- é‚®ä»¶èµ„æ–™ -->
      <el-tab-pane
        v-if="hasMailPermission"
        name="mail"
        label="é‚®ä»¶èµ„æ–™"
      >
        <MailMaterial
          v-if="activeTab === 'mail'"
          :is-search-collapsed="isSearchCollapsed"
        />
      </el-tab-pane>

      <!-- ç‰¹æ®Šèµ„æ–™ -->
      <el-tab-pane
        v-if="hasSpecialPermission"
        name="special"
        label="ç‰¹æ®Šèµ„æ–™"
      >
        <SpecialMaterial
          v-if="activeTab === 'special'"
          :is-search-collapsed="isSearchCollapsed"
        />
      </el-tab-pane>
    </el-tabs>

    <div class="toolbar">
      <el-button
        :icon="isSearchCollapsed ? ArrowDown : ArrowUp"
        @click="toggleSearchCollapse"
      >
        {{ isSearchCollapsed ? 'å±•å¼€æœç´¢' : 'æ”¶èµ·æœç´¢' }}
      </el-button>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, computed, provide } from 'vue'
import { ArrowDown, ArrowUp } from '@element-plus/icons-vue'
import { useUserStore } from '@/stores/user'
import ProductMaterial from './product/index.vue'
import EnterpriseMaterial from './enterprise/index.vue'
import MailMaterial from './mail/index.vue'
import SpecialMaterial from './special/index.vue'

const userStore = useUserStore()

const activeTab = ref('product')
const isSearchCollapsed = ref(false)

// æƒé™åˆ¤æ–­
const menuList = userStore.user?.menuList || []
const resourceMenu = menuList.find(item => item.menuCode === 'Resource')
const subMenuList = resourceMenu?.subMenuList || []

const hasProductPermission = computed(() => {
  return subMenuList.some(item => item.menuCode === 'Material_Product')
})

const hasEnterprisePermission = computed(() => {
  return subMenuList.some(item => item.menuCode === 'Material_Enterprise')
})

const hasMailPermission = computed(() => {
  return subMenuList.some(item => item.menuCode === 'Material_Mail')
})

const hasSpecialPermission = computed(() => {
  return subMenuList.some(item => item.menuCode === 'Material_Special')
})

// åˆ‡æ¢ Tab
const handleTabChange = (tabName: string) => {
  activeTab.value = tabName
}

// å±•å¼€/æ”¶èµ·æœç´¢
const toggleSearchCollapse = () => {
  isSearchCollapsed.value = !isSearchCollapsed.value
}

// æä¾›æœç´¢æŠ˜å çŠ¶æ€ç»™å­ç»„ä»¶
provide('isSearchCollapsed', isSearchCollapsed)
</script>

<style lang="scss" scoped>
.material-store {
  padding: $base-padding;

  .toolbar {
    margin-top: 20px;
  }
}
</style>
```

**ProductMaterial äº§å“èµ„æ–™ç»„ä»¶**ï¼š

```vue
<template>
  <div class="product-material">
    <!-- æœç´¢è¡¨å• -->
    <el-collapse-transition>
      <div v-show="!isSearchCollapsed">
        <el-form :model="searchForm" label-width="120px">
          <el-row :gutter="16">
            <el-col :span="8">
              <el-form-item label="äº§å“åç§°">
                <el-input v-model="searchForm.productName" clearable />
              </el-form-item>
            </el-col>

            <el-col :span="8">
              <el-form-item label="é€šç”¨å">
                <el-input v-model="searchForm.commonName" clearable />
              </el-form-item>
            </el-col>

            <el-col :span="8">
              <el-form-item label="èµ„æ–™ç±»å‹">
                <el-select v-model="searchForm.documentType" clearable>
                  <el-option
                    v-for="item in documentTypeOptions"
                    :key="item.value"
                    :label="item.label"
                    :value="item.value"
                  />
                </el-select>
              </el-form-item>
            </el-col>
          </el-row>

          <el-row>
            <el-col :span="8" :offset="16">
              <el-button @click="handleReset">é‡ç½®</el-button>
              <el-button type="primary" @click="handleSearch">æŸ¥è¯¢</el-button>
            </el-col>
          </el-row>
        </el-form>
      </div>
    </el-collapse-transition>

    <!-- æ“ä½œæŒ‰é’® -->
    <div class="action-section">
      <el-button
        v-if="canAdd"
        type="primary"
        :icon="Plus"
        @click="handleAdd"
      >
        æ–°å¢èµ„æ–™
      </el-button>

      <el-button
        :icon="Upload"
        @click="handleBatchUpload"
      >
        æ‰¹é‡ä¸Šä¼ 
      </el-button>
    </div>

    <!-- èµ„æ–™åˆ—è¡¨ -->
    <MaterialTable
      ref="materialTableRef"
      :search-form="searchForm"
    />
  </div>
</template>

<script setup lang="ts">
import { ref, reactive, inject, computed } from 'vue'
import { Plus, Upload } from '@element-plus/icons-vue'
import { useUserStore } from '@/stores/user'
import MaterialTable from './MaterialTable.vue'

interface Props {
  isSearchCollapsed: boolean
}

const props = defineProps<Props>()

const userStore = useUserStore()
const materialTableRef = ref()

const searchForm = reactive({
  productName: '',
  commonName: '',
  documentType: ''
})

const documentTypeOptions = ref([
  { label: 'æ‰¹å‡†æ–‡å·', value: 'P1' },
  { label: 'è¥ä¸šæ‰§ç…§', value: 'P2' },
  { label: 'ç”Ÿäº§è®¸å¯è¯', value: 'P3' },
  { label: 'GMPè¯ä¹¦', value: 'P4' }
])

const canAdd = computed(() => {
  const roleCode = userStore.user?.roles[0]?.roleCode
  return ['R0001', 'R0003', 'R0004'].includes(roleCode)
})

const handleSearch = () => {
  materialTableRef.value?.reload()
}

const handleReset = () => {
  searchForm.productName = ''
  searchForm.commonName = ''
  searchForm.documentType = ''
  materialTableRef.value?.reload()
}

const handleAdd = () => {
  // æ‰“å¼€æ–°å¢å¼¹çª—
}

const handleBatchUpload = () => {
  // æ‰“å¼€æ‰¹é‡ä¸Šä¼ å¼¹çª—
}
</script>

<style lang="scss" scoped>
.product-material {
  .action-section {
    display: flex;
    gap: 10px;
    margin: 20px 0;
  }
}
</style>
```

---

## å…­ã€å…¬å…±ç»„ä»¶ä½¿ç”¨

### 6.1 TablePage é€šç”¨è¡¨æ ¼ç»„ä»¶

**ç»„ä»¶ä½ç½®**ï¼š`src/common/component/TablePage.vue`

**åŠŸèƒ½ç‰¹ç‚¹**ï¼š
- âœ… å°è£…äº†åˆ†é¡µé€»è¾‘
- âœ… è‡ªåŠ¨åŠ è½½æ•°æ®
- âœ… æ”¯æŒé‡æ–°åŠ è½½
- âœ… æ”¯æŒå¤šé€‰

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```vue
<template>
  <TablePage
    ref="tablePageRef"
    :load-data="loadData"
    :auto-load="true"
  >
    <el-table-column prop="name" label="åç§°" />
    <el-table-column prop="status" label="çŠ¶æ€">
      <template #default="{ row }">
        <el-tag :type="row.status === 'active' ? 'success' : 'danger'">
          {{ row.status }}
        </el-tag>
      </template>
    </el-table-column>
    <el-table-column label="æ“ä½œ">
      <template #default="{ row }">
        <el-button size="small" @click="handleEdit(row)">ç¼–è¾‘</el-button>
        <el-button size="small" type="danger" @click="handleDelete(row)">
          åˆ é™¤
        </el-button>
      </template>
    </el-table-column>
  </TablePage>
</template>

<script setup lang="ts">
import { ref } from 'vue'

interface Item {
  id: number
  name: string
  status: string
}

const tablePageRef = ref()

// åŠ è½½æ•°æ®å‡½æ•°
const loadData = async ({ page, pageSize }: { page: number; pageSize: number }) => {
  // è°ƒç”¨ API
  const response = await getItems({
    pageNumber: page,
    pageSize: pageSize
  })

  return {
    list: response.data.records,       // æ•°æ®åˆ—è¡¨
    pageInfo: {
      pageNum: response.data.current,   // å½“å‰é¡µ
      pageSize: response.data.size,    // æ¯é¡µå¤§å°
      total: response.data.total       // æ€»æ•°
    }
  }
}

// é‡æ–°åŠ è½½
const reload = () => {
  tablePageRef.value?.reloadData(true)
}

// è·å–é€‰ä¸­çš„è¡Œ
const getSelectionRows = () => {
  return tablePageRef.value?.getSelectionRows()
}
</script>
```

### 6.2 ProvincePicker åœ°åŒºé€‰æ‹©å™¨

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```vue
<template>
  <el-form-item label="åœ°åŒº">
    <ProvincePicker v-model="form.regions" />
  </el-form-item>
</template>

<script setup lang="ts">
import { reactive } from 'vue'

const form = reactive({
  regions: [] as string[]  // ['110000', '310000', '440000']
})
</script>
```

### 6.3 SpecificationSelector è§„æ ¼é€‰æ‹©å™¨

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```vue
<template>
  <el-form-item label="è§„æ ¼">
    <SpecificationSelector
      ref="specificationSelectorRef"
      v-model="form.specification"
      :multiple="false"
      :common-name-list="commonNameList"
    />
  </el-form-item>
</template>

<script setup lang="ts">
import { ref, watch } from 'vue'

const specificationSelectorRef = ref()
const commonNameList = ref<string[]>([])

// å½“é€šç”¨åå˜åŒ–æ—¶ï¼Œé‡æ–°åŠ è½½è§„æ ¼
watch(() => form.commonName, (newVal) => {
  if (specificationSelectorRef.value) {
    specificationSelectorRef.value.loadOptions([newVal])
  }
})
</script>
```

---

## ä¸ƒã€å¼€å‘å®æˆ˜æ•™ç¨‹

### 7.1 åˆ›å»ºæ–°é¡µé¢

**æ­¥éª¤**ï¼š

1. **åˆ›å»ºé¡µé¢ç»„ä»¶**
```vue
<!-- src/views/demo/index.vue -->
<template>
  <div class="demo-container">
    <h2>Demo é¡µé¢</h2>
    <p>{{ message }}</p>
    <el-button @click="handleClick">ç‚¹å‡»æˆ‘</el-button>
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue'

defineOptions({
  name: 'DemoPage'
})

const message = ref('Hello, Vue 3!')

const handleClick = () => {
  alert('æŒ‰é’®è¢«ç‚¹å‡»äº†')
}
</script>

<style lang="scss" scoped>
.demo-container {
  padding: $base-padding;

  h2 {
    color: $base-color-default;
  }
}
</style>
```

2. **æ·»åŠ è·¯ç”±**
```typescript
// router/index.ts
{
  path: '/demo',
  component: () => import('@/layouts/index.vue'),
  name: 'Demo',
  meta: {
    title: 'Demo',
    icon: 'Star'
  },
  children: [
    {
      path: 'index',
      name: 'DemoIndex',
      component: () => import('@/views/demo/index.vue'),
      meta: {
        title: 'Demoé¡µé¢',
        icon: 'Star'
      }
    }
  ]
}
```

3. **è®¿é—®é¡µé¢**
```
http://localhost:5173/demo/index
```

### 7.2 åˆ›å»º API æ¥å£

```typescript
// api/demo.ts
import http from '@/common/http'

// å®šä¹‰ç±»å‹
export interface DemoItem {
  id: number
  name: string
  status: string
}

export interface DemoListParams {
  pageNumber: number
  pageSize: number
  keyword?: string
}

// API æ–¹æ³•
export const getDemoList = (params: DemoListParams) => {
  return http.post('/demo/list', params)
}

export const getDemoDetail = (id: number) => {
  return http.get(`/demo/detail/${id}`)
}

export const createDemo = (data: any) => {
  return http.post('/demo/create', data)
}

export const updateDemo = (id: number, data: any) => {
  return http.put(`/demo/update/${id}`, data)
}

export const deleteDemo = (id: number) => {
  return http.delete(`/demo/delete/${id}`)
}
```

### 7.3 åˆ›å»ºå…¬å…±ç»„ä»¶

```vue
<!-- components/UserCard.vue -->
<template>
  <el-card class="user-card">
    <div class="user-avatar">
      <el-avatar :size="80" :src="user.avatar" />
    </div>
    <div class="user-info">
      <h3>{{ user.name }}</h3>
      <p>{{ user.email }}</p>
      <el-tag :type="user.status === 'active' ? 'success' : 'danger'">
        {{ user.status }}
      </el-tag>
    </div>
    <div class="user-actions">
      <slot name="actions">
        <el-button size="small">æŸ¥çœ‹è¯¦æƒ…</el-button>
      </slot>
    </div>
  </el-card>
</template>

<script setup lang="ts">
defineOptions({
  name: 'UserCard'
})

interface User {
  id: number
  name: string
  email: string
  avatar: string
  status: string
}

const props = defineProps<{
  user: User
}>()

defineExpose({
  getUser: () => props.user
})
</script>

<style lang="scss" scoped>
.user-card {
  text-align: center;

  .user-avatar {
    margin-bottom: 15px;
  }

  .user-info {
    h3 {
      margin: 0 0 10px 0;
    }

    p {
      color: #999;
      margin: 0 0 10px 0;
    }
  }

  .user-actions {
    margin-top: 15px;
  }
}
</style>
```

**ä½¿ç”¨ç»„ä»¶**ï¼š
```vue
<template>
  <UserCard :user="userInfo">
    <template #actions>
      <el-button size="small" @click="handleEdit">ç¼–è¾‘</el-button>
      <el-button size="small" type="danger" @click="handleDelete">
        åˆ é™¤
      </el-button>
    </template>
  </UserCard>
</template>

<script setup lang="ts">
import UserCard from '@/components/UserCard.vue'

const userInfo = ref({
  id: 1,
  name: 'å¼ ä¸‰',
  email: 'zhangsan@example.com',
  avatar: 'https://example.com/avatar.jpg',
  status: 'active'
})
</script>
```

### 7.4 è¡¨å•éªŒè¯å®æˆ˜

```vue
<template>
  <el-form
    ref="formRef"
    :model="form"
    :rules="rules"
    label-width="120px"
  >
    <el-form-item label="ç”¨æˆ·å" prop="username">
      <el-input v-model="form.username" clearable />
    </el-form-item>

    <el-form-item label="é‚®ç®±" prop="email">
      <el-input v-model="form.email" clearable />
    </el-form-item>

    <el-form-item label="æ‰‹æœºå·" prop="phone">
      <el-input v-model="form.phone" clearable />
    </el-form-item>

    <el-form-item label="å¯†ç " prop="password">
      <el-input
        v-model="form.password"
        type="password"
        show-password
      />
    </el-form-item>

    <el-form-item label="ç¡®è®¤å¯†ç " prop="confirmPassword">
      <el-input
        v-model="form.confirmPassword"
        type="password"
        show-password
      />
    </el-form-item>

    <el-form-item>
      <el-button type="primary" @click="handleSubmit">æäº¤</el-button>
      <el-button @click="handleReset">é‡ç½®</el-button>
    </el-form-item>
  </el-form>
</template>

<script setup lang="ts">
import { ref, reactive } from 'vue'
import { ElMessage } from 'element-plus'
import type { FormInstance, FormRules } from 'element-plus'

const formRef = ref<FormInstance>()

const form = reactive({
  username: '',
  email: '',
  phone: '',
  password: '',
  confirmPassword: ''
})

// è‡ªå®šä¹‰éªŒè¯è§„åˆ™
const validatePhone = (rule: any, value: any, callback: any) => {
  if (!value) {
    callback(new Error('è¯·è¾“å…¥æ‰‹æœºå·'))
  } else if (!/^1[3-9]\d{9}$/.test(value)) {
    callback(new Error('æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®'))
  } else {
    callback()
  }
}

const validateConfirmPassword = (rule: any, value: any, callback: any) => {
  if (!value) {
    callback(new Error('è¯·å†æ¬¡è¾“å…¥å¯†ç '))
  } else if (value !== form.password) {
    callback(new Error('ä¸¤æ¬¡è¾“å…¥å¯†ç ä¸ä¸€è‡´'))
  } else {
    callback()
  }
}

const rules: FormRules = {
  username: [
    { required: true, message: 'è¯·è¾“å…¥ç”¨æˆ·å', trigger: 'blur' },
    { min: 3, max: 20, message: 'é•¿åº¦åœ¨ 3 åˆ° 20 ä¸ªå­—ç¬¦', trigger: 'blur' }
  ],
  email: [
    { required: true, message: 'è¯·è¾“å…¥é‚®ç®±', trigger: 'blur' },
    { type: 'email', message: 'é‚®ç®±æ ¼å¼ä¸æ­£ç¡®', trigger: 'blur' }
  ],
  phone: [
    { required: true, validator: validatePhone, trigger: 'blur' }
  ],
  password: [
    { required: true, message: 'è¯·è¾“å…¥å¯†ç ', trigger: 'blur' },
    { min: 6, message: 'å¯†ç è‡³å°‘6ä½', trigger: 'blur' }
  ],
  confirmPassword: [
    { required: true, validator: validateConfirmPassword, trigger: 'blur' }
  ]
}

const handleSubmit = async () => {
  if (!formRef.value) return

  try {
    await formRef.value.validate()
    // æäº¤è¡¨å•
    await submitForm(form)
    ElMessage.success('æäº¤æˆåŠŸ')
  } catch (error) {
    ElMessage.error('è¡¨å•éªŒè¯å¤±è´¥')
  }
}

const handleReset = () => {
  formRef.value?.resetFields()
}
</script>
```

### 7.5 åˆ—è¡¨æŸ¥è¯¢å®æˆ˜

```vue
<template>
  <div class="list-page">
    <!-- æœç´¢è¡¨å• -->
    <el-form :model="searchForm" inline>
      <el-form-item label="åç§°">
        <el-input v-model="searchForm.name" clearable />
      </el-form-item>

      <el-form-item label="çŠ¶æ€">
        <el-select v-model="searchForm.status" clearable>
          <el-option label="å¯ç”¨" value="1" />
          <el-option label="ç¦ç”¨" value="0" />
        </el-select>
      </el-form-item>

      <el-form-item>
        <el-button type="primary" @click="handleSearch">æŸ¥è¯¢</el-button>
        <el-button @click="handleReset">é‡ç½®</el-button>
      </el-form-item>
    </el-form>

    <!-- æ“ä½œæŒ‰é’® -->
    <div class="action-section">
      <el-button type="primary" :icon="Plus" @click="handleAdd">
        æ–°å¢
      </el-button>
      <el-button :icon="Delete" @click="handleBatchDelete">
        æ‰¹é‡åˆ é™¤
      </el-button>
    </div>

    <!-- åˆ—è¡¨è¡¨æ ¼ -->
    <TablePage
      ref="tablePageRef"
      :load-data="loadData"
    >
      <el-table-column type="selection" width="55" />
      <el-table-column prop="name" label="åç§°" />
      <el-table-column prop="status" label="çŠ¶æ€">
        <template #default="{ row }">
          <el-tag :type="row.status === '1' ? 'success' : 'danger'">
            {{ row.status === '1' ? 'å¯ç”¨' : 'ç¦ç”¨' }}
          </el-tag>
        </template>
      </el-table-column>
      <el-table-column prop="createTime" label="åˆ›å»ºæ—¶é—´" />
      <el-table-column label="æ“ä½œ" width="200">
        <template #default="{ row }">
          <el-button size="small" @click="handleEdit(row)">ç¼–è¾‘</el-button>
          <el-button size="small" type="danger" @click="handleDelete(row)">
            åˆ é™¤
          </el-button>
        </template>
      </el-table-column>
    </TablePage>
  </div>
</template>

<script setup lang="ts">
import { ref, reactive } from 'vue'
import { Plus, Delete } from '@element-plus/icons-vue'
import { ElMessage, ElMessageBox } from 'element-plus'
import TablePage from '@/common/component/TablePage.vue'
import { getList, deleteItem, batchDeleteItems } from '@/api/demo'

const tablePageRef = ref()

const searchForm = reactive({
  name: '',
  status: ''
})

// åŠ è½½æ•°æ®
const loadData = async ({ page, pageSize }) => {
  const response = await getList({
    pageNumber: page,
    pageSize: pageSize,
    name: searchForm.name,
    status: searchForm.status
  })

  return {
    list: response.data.records,
    pageInfo: {
      pageNum: response.data.current,
      pageSize: response.data.size,
      total: response.data.total
    }
  }
}

// æœç´¢
const handleSearch = () => {
  tablePageRef.value?.reloadData(true)
}

// é‡ç½®
const handleReset = () => {
  searchForm.name = ''
  searchForm.status = ''
  tablePageRef.value?.reloadData(true)
}

// æ–°å¢
const handleAdd = () => {
  // æ‰“å¼€æ–°å¢å¼¹çª—
}

// ç¼–è¾‘
const handleEdit = (row: any) => {
  // æ‰“å¼€ç¼–è¾‘å¼¹çª—
}

// åˆ é™¤
const handleDelete = async (row: any) => {
  try {
    await ElMessageBox.confirm('ç¡®å®šè¦åˆ é™¤å—ï¼Ÿ', 'æç¤º', {
      type: 'warning'
    })

    await deleteItem(row.id)
    ElMessage.success('åˆ é™¤æˆåŠŸ')
    tablePageRef.value?.reloadData(true)
  } catch (error) {
    // å–æ¶ˆåˆ é™¤
  }
}

// æ‰¹é‡åˆ é™¤
const handleBatchDelete = async () => {
  const selectedRows = tablePageRef.value?.getSelectionRows()

  if (!selectedRows || selectedRows.length === 0) {
    ElMessage.warning('è¯·å…ˆé€‰æ‹©è¦åˆ é™¤çš„æ•°æ®')
    return
  }

  try {
    await ElMessageBox.confirm(`ç¡®å®šè¦åˆ é™¤é€‰ä¸­çš„ ${selectedRows.length} æ¡æ•°æ®å—ï¼Ÿ`, 'æç¤º', {
      type: 'warning'
    })

    const ids = selectedRows.map(row => row.id)
    await batchDeleteItems(ids)
    ElMessage.success('åˆ é™¤æˆåŠŸ')
    tablePageRef.value?.reloadData(true)
  } catch (error) {
    // å–æ¶ˆåˆ é™¤
  }
}
</script>
```

---

## å…«ã€å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

### 8.1 å¼€å‘é—®é¢˜

**Q1: Vite å¯åŠ¨æŠ¥é”™ "Cannot find module '@/xxx'"**

**A**: æ£€æŸ¥ `vite.config.ts` ä¸­çš„è·¯å¾„åˆ«åé…ç½®
```typescript
resolve: {
  alias: {
    '@': fileURLToPath(new URL('./src', import.meta.url))
  }
}
```

åŒæ—¶æ£€æŸ¥ `tsconfig.json`ï¼š
```json
{
  "compilerOptions": {
    "paths": {
      "@/*": ["./src/*"]
    }
  }
}
```

**Q2: SCSS å˜é‡æ— æ³•ä½¿ç”¨**

**A**: æ£€æŸ¥ `vite.config.ts` ä¸­æ˜¯å¦é…ç½®äº†å…¨å±€å˜é‡æ³¨å…¥
```typescript
css: {
  preprocessorOptions: {
    scss: {
      additionalData: `@use "@/styles/variables.scss" as *;`
    }
  }
}
```

**Q3: ç»„ä»¶ç¼“å­˜å¤±æ•ˆ**

**A**: ç¡®ä¿ç»„ä»¶æœ‰ `name` å±æ€§
```vue
<script setup lang="ts">
defineOptions({
  name: 'ComponentName'  // å¿…é¡»è¦æœ‰ name
})
</script>
```

**Q4: è·¯ç”±è·³è½¬ä¸ç”Ÿæ•ˆ**

**A**: æ£€æŸ¥è·¯ç”±æ˜¯å¦æ­£ç¡®æ³¨å†Œ
```typescript
{
  path: '/demo',
  name: 'Demo',  // å¿…é¡»è¦æœ‰ name
  component: () => import('@/views/demo/index.vue')
}
```

### 8.2 æ€§èƒ½é—®é¢˜

**Q5: é¡µé¢åŠ è½½æ…¢**

**A**: ä½¿ç”¨è·¯ç”±æ‡’åŠ è½½
```typescript
// âŒ åŒæ­¥åŠ è½½
import HomePage from '@/views/home/index.vue'

// âœ… æ‡’åŠ è½½
component: () => import('@/views/home/index.vue')
```

**Q6: åˆ—è¡¨æ•°æ®å¤ªå¤šå¡é¡¿**

**A**: ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨
```vue
<template>
  <el-table-v2
    :columns="columns"
    :data="data"
    :width="700"
    :height="400"
    fixed
  />
</template>
```

### 8.3 å…¼å®¹æ€§é—®é¢˜

**Q7: IE æµè§ˆå™¨ä¸æ”¯æŒ**

**A**: Vite é»˜è®¤ä¸æ”¯æŒ IEï¼Œå¦‚æœéœ€è¦æ”¯æŒ IEï¼Œéœ€è¦ä½¿ç”¨å…¶ä»–æ„å»ºå·¥å…·ï¼ˆå¦‚ Webpackï¼‰ã€‚

---

## ä¹ã€æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 9.1 ä»£ç ä¼˜åŒ–

1. **ä½¿ç”¨ computed ç¼“å­˜è®¡ç®—ç»“æœ**
```typescript
// âŒ æ¯æ¬¡éƒ½è®¡ç®—
const fullName = firstName.value + ' ' + lastName.value

// âœ… ä½¿ç”¨ computedï¼ˆæœ‰ç¼“å­˜ï¼‰
const fullName = computed(() => firstName.value + ' ' + lastName.value)
```

2. **ä½¿ç”¨ v-show æ›¿ä»£ v-ifï¼ˆé¢‘ç¹åˆ‡æ¢ï¼‰**
```vue
<!-- âŒ é¢‘ç¹åˆ‡æ¢æ—¶æ€§èƒ½å·® -->
<div v-if="show">å†…å®¹</div>

<!-- âœ… é¢‘ç¹åˆ‡æ¢æ—¶æ€§èƒ½å¥½ -->
<div v-show="show">å†…å®¹</div>
```

3. **åˆç†ä½¿ç”¨ keep-alive**
```vue
<router-view v-slot="{ Component }">
  <keep-alive>
    <component :is="Component" />
  </keep-alive>
</router-view>
```

### 9.2 æ‰“åŒ…ä¼˜åŒ–

1. **è·¯ç”±æ‡’åŠ è½½**
```typescript
component: () => import('@/views/demo/index.vue')
```

2. **CDN åŠ é€Ÿ**
```html
<!-- index.html -->
<script src="https://cdn.jsdelivr.net/npm/vue@3.5.22/dist/vue.global.prod.js"></script>
```

3. **Gzip å‹ç¼©**
```typescript
// vite.config.ts
import viteCompression from 'vite-plugin-compression'

export default defineConfig({
  plugins: [
    vue(),
    viteCompression({
      algorithm: 'gzip',
      ext: '.gz'
    })
  ]
})
```

### 9.3 è¯·æ±‚ä¼˜åŒ–

1. **é˜²æŠ–å’ŒèŠ‚æµ**
```typescript
import { useDebounceFn, useThrottleFn } from '@vueuse/core'

// é˜²æŠ–
const debouncedSearch = useDebounceFn(() => {
  loadData()
}, 500)

// èŠ‚æµ
const throttledScroll = useThrottleFn(() => {
  handleScroll()
}, 200)
```

2. **è¯·æ±‚å–æ¶ˆ**
```typescript
import { ref, onUnmounted } from 'vue'
import axios from 'axios'

const controller = new AbortController()

const loadData = async () => {
  try {
    const response = await axios.get('/api/data', {
      signal: controller.signal
    })
  } catch (error) {
    if (axios.isCancel(error)) {
      console.log('è¯·æ±‚å·²å–æ¶ˆ')
    }
  }
}

onUnmounted(() => {
  controller.abort()
})
```

---

## æ€»ç»“

æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»äº†æ‹œè€³æ™ºèƒ½æ‹›é‡‡å¹³å°çš„å‰ç«¯æŠ€æœ¯æ ˆå’Œå®ç°ç»†èŠ‚ï¼ŒåŒ…æ‹¬ï¼š

âœ… Vue 3 + TypeScript + Vite æ ¸å¿ƒæŠ€æœ¯
âœ… Element Plus UI ç»„ä»¶åº“çš„ä½¿ç”¨
âœ… Pinia çŠ¶æ€ç®¡ç†
âœ… Vue Router è·¯ç”±ç®¡ç†
âœ… Axios HTTP è¯·æ±‚å°è£…
âœ… ç»„ä»¶é€šä¿¡å’Œå¤ç”¨
âœ… è¡¨å•å’Œåˆ—è¡¨å®ç°
âœ… æ€§èƒ½ä¼˜åŒ–å»ºè®®

å¸Œæœ›è¿™ä»½æ–‡æ¡£èƒ½å¸®åŠ©å‰ç«¯æ–°æ‰‹å¿«é€Ÿä¸Šæ‰‹é¡¹ç›®å¼€å‘ï¼
